function loadData(e){printProductivityScore(e),printMainStats(e)}function printMainStats(e){maxTime=0,maxTime_website=0,maxVisits=0,maxVisits_website=0,numberOfWebsitesVisited=0,totalTimeLogged=0;var t=e;"all"==e&&(t="total"),chrome.storage.local.get("websites",function(e){var i=e.websites;for(key in i){var a=i[key];a[t+"_visits"]>0&&(numberOfWebsitesVisited++,totalTimeLogged+=a[t+"_time"],console.log(a[t+"_time"]),a[t+"_time"]>maxTime&&(maxTime=a[t+"_time"],maxTime_website=a._id),a[t+"_visits"]>maxVisits&&(maxVisits=a[t+"_visits"],maxVisits_website=a._id))}$(".overview-stats .time-logged .description").html(formatTime(totalTimeLogged)),$(".overview-stats .websites-visited .description em").text(numberOfWebsitesVisited),$(".overview-stats .most-visited .description").text(maxVisits_website),$(".overview-stats .most-time .description").text(maxTime_website)})}function formatTime(e){var t=Math.floor(e/1e3),i=Math.floor(t/60);if(60>i)return 1==i?"<em>"+i+"</em> minute logged":"<em>"+i+"</em> minutes logged";var a=Math.floor(i/60);return 1==a?"<em>"+a+"</em> hour logged":"<em>"+a+"</em> hours logged"}function printProductivityScore(e){var t="total_time";"day"==e?t="day_time":"week"==e?t="week_time":"month"==e?t="month_time":e="total_time";var i=0,a=0;chrome.storage.local.get("categories",function(e){var o=e.categories;for(key in o){var s=o[key];$.inArray(s._id,unproductiveCategories)>-1?a+=s[t]:$.inArray(s._id,productiveCategories)>-1&&(i+=s[t])}var r=Math.floor(i/(i+a)*100);console.log("Productive time: "+i),console.log("Unproductive time: "+a),console.log("Productivity score: "+r),0==i&&0==a&&(r=50);var n=[{value:r,color:"#9CC671",highlight:"#72A43F",label:"productive"},{value:100-r,color:"#EE8383",highlight:"#FF7070",label:"unproductive"}];$(".productivity-score").text(r),$("#productivityScoreChart").replaceWith('<canvas id="productivityScoreChart" width="217" height="217"></canvas>');var m=document.getElementById("productivityScoreChart").getContext("2d");window.myPie=new Chart(m).Doughnut(n,{segmentShowStroke:!1,percentageInnerCutout:85})})}var unproductiveCategories=["Gambling","Games","Internet and Telecom","Social","People and Society","Sports","Shopping","Adult","News and Media","Arts and Entertainment"],productiveCategories=["Books","Business","Beauty and Fitness","Finance","Career and Education","Law and Government","Science","Search","Reference","Computer and Electronics"],maxTime=0,maxTime_website="",maxVisits=0,maxVisits_website="",numberOfWebsitesVisited=0,totalTimeLogged=0;loadData("day"),$(document).ready(function(){$(".header .bottom-menu a").click(function(){$(".header .bottom-menu a").removeClass("active"),$(this).addClass("active"),$(this).hasClass("day")?loadData("day"):$(this).hasClass("week")?loadData("week"):$(this).hasClass("month")?loadData("month"):$(this).hasClass("all")&&loadData("all"),event.preventDefault()})});