function loadData(e){printProductivityScore(e),printMainStats(e),loadFocusModeInfo()}function printMainStats(e){maxTime=0,maxTime_website=0,maxVisits=0,maxVisits_website=0,numberOfWebsitesVisited=0,totalTimeLogged=0;var t=e;"all"==e&&(t="total"),chrome.storage.local.get("websites",function(e){var i=e.websites;for(key in i){var o=i[key];o[t+"_visits"]>0&&(numberOfWebsitesVisited++,totalTimeLogged+=o[t+"_time"],console.log(o[t+"_time"]),o[t+"_time"]>maxTime&&(maxTime=o[t+"_time"],maxTime_website=o._id),o[t+"_visits"]>maxVisits&&(maxVisits=o[t+"_visits"],maxVisits_website=o._id))}$(".overview-stats .time-logged .description").html(formatTime(totalTimeLogged)),$(".overview-stats .websites-visited .description em").text(numberOfWebsitesVisited),$(".overview-stats .most-visited .description").text(maxVisits_website),$(".overview-stats .most-time .description").text(maxTime_website)})}function formatTime(e){var t=Math.floor(e/1e3),i=Math.floor(t/60);if(60>i)return 1==i?"<em>"+i+"</em> minute logged":"<em>"+i+"</em> minutes logged";var o=Math.floor(i/60);return 1==o?"<em>"+o+"</em> hour logged":"<em>"+o+"</em> hours logged"}function printProductivityScore(e){var t="total_time";"day"==e?t="day_time":"week"==e?t="week_time":"month"==e?t="month_time":e="total_time";var i=0,o=0;chrome.storage.local.get("categories",function(e){var a=e.categories;for(key in a){var s=a[key];$.inArray(s._id,unproductiveCategories)>-1?o+=s[t]:$.inArray(s._id,productiveCategories)>-1&&(i+=s[t])}var n=Math.floor(i/(i+o)*100);console.log("Productive time: "+i),console.log("Unproductive time: "+o),console.log("Productivity score: "+n),0==i&&0==o&&(n=50);var r=[{value:n,color:"#9CC671",highlight:"#72A43F",label:"productive"},{value:100-n,color:"#EE8383",highlight:"#FF7070",label:"unproductive"}];$(".productivity-score").text(n),$("#productivityScoreChart").replaceWith('<canvas id="productivityScoreChart" width="217" height="217"></canvas>');var m=document.getElementById("productivityScoreChart").getContext("2d");window.myPie=new Chart(m).Doughnut(r,{segmentShowStroke:!1,percentageInnerCutout:85})})}function loadFocusModeInfo(){chrome.storage.local.get("settings",function(e){var t=e.settings;$(".button.focus-mode").text(t.focus?"Exit focus mode":"Enter focus mode")})}var unproductiveCategories=["Gambling","Games","Internet and Telecom","Social","People and Society","Sports","Shopping","Adult","News and Media","Arts and Entertainment"],productiveCategories=["Books","Business","Beauty and Fitness","Finance","Career and Education","Law and Government","Science","Search","Reference","Computer and Electronics"],maxTime=0,maxTime_website="",maxVisits=0,maxVisits_website="",numberOfWebsitesVisited=0,totalTimeLogged=0;loadData("day"),$(document).ready(function(){$(".header .bottom-menu a").click(function(){$(".header .bottom-menu a").removeClass("active"),$(this).addClass("active"),$(this).hasClass("day")?loadData("day"):$(this).hasClass("week")?loadData("week"):$(this).hasClass("month")?loadData("month"):$(this).hasClass("all")&&loadData("all"),event.preventDefault()}),$(".button.focus-mode").click(function(){chrome.storage.local.get("settings",function(e){var t=e.settings;t.focus?($(".button.focus-mode").text("Enter focus mode"),t.focus=!1):($(".button.focus-mode").text("Exit focus mode"),t.focus=!0),e.settings=t,chrome.storage.local.set(e,function(){console.log("New data stored for settings")})}),event.preventDefault()})});