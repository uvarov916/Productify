function loadData(t){printProductivityScore(t),printMainStats(t),loadFocusModeInfo(),printCategoryData(t)}function printMainStats(t){maxTime=0,maxTime_website=0,maxVisits=0,maxVisits_website=0,numberOfWebsitesVisited=0,totalTimeLogged=0;var e=t;"all"==t&&(e="total"),chrome.storage.local.get("websites",function(t){var o=t.websites;for(key in o){var i=o[key];i[e+"_visits"]>0&&(numberOfWebsitesVisited++,totalTimeLogged+=i[e+"_time"],console.log(i[e+"_time"]),i[e+"_time"]>maxTime&&(maxTime=i[e+"_time"],maxTime_website=i._id),i[e+"_visits"]>maxVisits&&(maxVisits=i[e+"_visits"],maxVisits_website=i._id))}$(".overview-stats .time-logged .description").html(formatTime(totalTimeLogged)),$(".overview-stats .websites-visited .description em").text(numberOfWebsitesVisited),$(".overview-stats .most-visited .description").text(maxVisits_website),$(".overview-stats .most-time .description").text(maxTime_website)})}function formatTime(t){var e=Math.floor(t/1e3),o=Math.floor(e/60);if(60>o)return 1==o?"<em>"+o+"</em> minute logged":"<em>"+o+"</em> minutes logged";var i=Math.floor(o/60);return 1==i?"<em>"+i+"</em> hour logged":"<em>"+i+"</em> hours logged"}function printProductivityScore(t){var e="total_time";"day"==t?e="day_time":"week"==t?e="week_time":"month"==t?e="month_time":t="total_time";var o=0,i=0;chrome.storage.local.get("categories",function(t){var s=t.categories;for(key in s){var a=s[key];$.inArray(a._id,unproductiveCategories)>-1?i+=a[e]:$.inArray(a._id,productiveCategories)>-1&&(o+=a[e])}var r=Math.floor(o/(o+i)*100);console.log("Productive time: "+o),console.log("Unproductive time: "+i),console.log("Productivity score: "+r),0==o&&0==i&&(r=50);var n=[{value:r,color:"#9CC671",highlight:"#72A43F",label:"productive"},{value:100-r,color:"#EE8383",highlight:"#FF7070",label:"unproductive"}];$(".productivity-score").text(r),$("#productivityScoreChart").replaceWith('<canvas id="productivityScoreChart" width="217" height="217"></canvas>');var c=document.getElementById("productivityScoreChart").getContext("2d");window.myPie=new Chart(c).Doughnut(n,{segmentShowStroke:!1,percentageInnerCutout:85})})}function loadFocusModeInfo(){chrome.storage.local.get("settings",function(t){var e=t.settings;e.focus?$(".button.focus-mode").text("Exit focus mode").removeClass("off").addClass("on"):$(".button.focus-mode").text("Enter focus mode").removeClass("on").addClass("off")})}function printCategoryData(t){chrome.storage.local.get("categories",function(e){for(var o=e.categories,i=[],s=0;5>=s;s++)i[s]={},i[s]._id="-",i[s][t+"_time"]=0;for(key in o){var a=o[key],r=a[t+"_time"];if(r>i[5][t+"_time"]){i[5]=a;for(var s=4;s>=0;s--)r>i[s][t+"_time"]&&(i[s+1]=i[s],i[s]=a)}}for(var s=0;6>s;s++)console.log("------> "+i[s][t+"_time"]);console.log(i);for(var n=0,c=[],s=0;5>=s;s++)n+=i[s][t+"_time"],c[s]=i[s][t+"_time"];for(var s=0;5>s;s++)c[s]=Math.floor(c[s]/n*100);c[5]=100-c[0]-c[1]-c[2]-c[3]-c[4],$(".category-bar .first").css("width",c[0].toString()+"%"),$(".category-bar .second").css("width",c[1].toString()+"%"),$(".category-bar .third").css("width",c[2].toString()+"%"),$(".category-bar .fourth").css("width",c[3].toString()+"%"),$(".category-bar .fifth").css("width",c[4].toString()+"%"),$(".category-bar .sixth").css("width",c[5].toString()+"%"),$(".category-stats .row > .first .description").text(i[0]._id),$(".category-stats .row > .second .description").text(i[1]._id),$(".category-stats .row > .third .description").text(i[2]._id),$(".category-stats .row > .fourth .description").text(i[3]._id),$(".category-stats .row > .fifth .description").text(i[4]._id),$(".category-stats .row > .sixth .description").text(i[5]._id)})}var unproductiveCategories=["Gambling","Games","Internet and Telecom","Social","People and Society","Sports","Shopping","Adult","News and Media","Arts and Entertainment"],productiveCategories=["Books","Business","Beauty and Fitness","Finance","Career and Education","Law and Government","Science","Search","Reference","Computer and Electronics"],maxTime=0,maxTime_website="",maxVisits=0,maxVisits_website="",numberOfWebsitesVisited=0,totalTimeLogged=0;loadData("day"),$(document).ready(function(){$(".header .bottom-menu a").click(function(){$(".header .bottom-menu a").removeClass("active"),$(this).addClass("active"),$(this).hasClass("day")?loadData("day"):$(this).hasClass("week")?loadData("week"):$(this).hasClass("month")?loadData("month"):$(this).hasClass("all")&&loadData("total"),event.preventDefault()}),$(".button.focus-mode").click(function(){chrome.storage.local.get("settings",function(t){var e=t.settings;e.focus?($(".button.focus-mode").text("Enter focus mode").removeClass("on").addClass("off"),e.focus=!1):($(".button.focus-mode").text("Exit focus mode").removeClass("off").addClass("on"),e.focus=!0),t.settings=e,chrome.storage.local.set(t,function(){console.log("New data stored for settings")})}),event.preventDefault()})});