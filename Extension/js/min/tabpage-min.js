function loadData(e){printProductivityScore(e),printMainStats(e),loadFocusModeInfo()}function printMainStats(e){maxTime=0,maxTime_website=0,maxVisits=0,maxVisits_website=0,numberOfWebsitesVisited=0,totalTimeLogged=0;var t=e;"all"==e&&(t="total"),chrome.storage.local.get("websites",function(e){var o=e.websites;for(key in o){var i=o[key];i[t+"_visits"]>0&&(numberOfWebsitesVisited++,totalTimeLogged+=i[t+"_time"],console.log(i[t+"_time"]),i[t+"_time"]>maxTime&&(maxTime=i[t+"_time"],maxTime_website=i._id),i[t+"_visits"]>maxVisits&&(maxVisits=i[t+"_visits"],maxVisits_website=i._id))}$(".overview-stats .time-logged .description").html(formatTime(totalTimeLogged)),$(".overview-stats .websites-visited .description em").text(numberOfWebsitesVisited),$(".overview-stats .most-visited .description").text(maxVisits_website),$(".overview-stats .most-time .description").text(maxTime_website)})}function formatTime(e){var t=Math.floor(e/1e3),o=Math.floor(t/60);if(60>o)return 1==o?"<em>"+o+"</em> minute logged":"<em>"+o+"</em> minutes logged";var i=Math.floor(o/60);return 1==i?"<em>"+i+"</em> hour logged":"<em>"+i+"</em> hours logged"}function printProductivityScore(e){var t="total_time";"day"==e?t="day_time":"week"==e?t="week_time":"month"==e?t="month_time":e="total_time";var o=0,i=0;chrome.storage.local.get("categories",function(e){var s=e.categories;for(key in s){var a=s[key];$.inArray(a._id,unproductiveCategories)>-1?i+=a[t]:$.inArray(a._id,productiveCategories)>-1&&(o+=a[t])}var n=Math.floor(o/(o+i)*100);console.log("Productive time: "+o),console.log("Unproductive time: "+i),console.log("Productivity score: "+n),0==o&&0==i&&(n=50);var r=[{value:n,color:"#9CC671",highlight:"#72A43F",label:"productive"},{value:100-n,color:"#EE8383",highlight:"#FF7070",label:"unproductive"}];$(".productivity-score").text(n),$("#productivityScoreChart").replaceWith('<canvas id="productivityScoreChart" width="217" height="217"></canvas>');var m=document.getElementById("productivityScoreChart").getContext("2d");window.myPie=new Chart(m).Doughnut(r,{segmentShowStroke:!1,percentageInnerCutout:85})})}function loadFocusModeInfo(){chrome.storage.local.get("settings",function(e){var t=e.settings;t.focus?$(".button.focus-mode").text("Exit focus mode").removeClass("off").addClass("on"):$(".button.focus-mode").text("Enter focus mode").removeClass("on").addClass("off")})}var unproductiveCategories=["Gambling","Games","Internet and Telecom","Social","People and Society","Sports","Shopping","Adult","News and Media","Arts and Entertainment"],productiveCategories=["Books","Business","Beauty and Fitness","Finance","Career and Education","Law and Government","Science","Search","Reference","Computer and Electronics"],maxTime=0,maxTime_website="",maxVisits=0,maxVisits_website="",numberOfWebsitesVisited=0,totalTimeLogged=0;loadData("day"),$(document).ready(function(){$(".header .bottom-menu a").click(function(){$(".header .bottom-menu a").removeClass("active"),$(this).addClass("active"),$(this).hasClass("day")?loadData("day"):$(this).hasClass("week")?loadData("week"):$(this).hasClass("month")?loadData("month"):$(this).hasClass("all")&&loadData("all"),event.preventDefault()}),$(".button.focus-mode").click(function(){chrome.storage.local.get("settings",function(e){var t=e.settings;t.focus?($(".button.focus-mode").text("Enter focus mode").removeClass("on").addClass("off"),t.focus=!1):($(".button.focus-mode").text("Exit focus mode").removeClass("off").addClass("on"),t.focus=!0),e.settings=t,chrome.storage.local.set(e,function(){console.log("New data stored for settings")})}),event.preventDefault()})});